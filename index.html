<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Unblocked Games</title>
  <style>
    body { font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background: linear-gradient(135deg,#0f172a,#0f1226); color: #e6eef8; min-height:100vh; display:flex; align-items:center; justify-content:center; }
    .card { background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02)); padding:28px; border-radius:12px; width:min(720px,92vw); box-shadow: 0 8px 40px rgba(2,6,23,0.6); }
    h1 { margin:0 0 8px 0; font-size:28px; }
    p { margin:0 0 16px 0; color:#bcd3ff; }
    .games { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    a.game { display:block; padding:12px 14px; border-radius:8px; background:linear-gradient(180deg,#11203a,#0b1730); color:#e6f0ff; text-decoration:none; box-shadow: inset 0 -2px 0 rgba(255,255,255,0.02); }
    a.game:hover { transform:translateY(-3px); transition:all .15s ease; }
    footer { margin-top:16px; font-size:13px; color:#8fa7d9; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Unblocked Games</h1>
    <p>Available games in this workspace. Click to open a game. The site supports offline usage and will cache assets after first visit.</p>

    <div class="games">
      <a class="game" href="/suika/">Suika / Watermelon Game Clone</a>
    </div>

    <p style="margin-top:12px">
      <button id="download-offline" style="padding:8px 12px;border-radius:8px;border:0;background:#1f6feb;color:white;cursor:pointer">Download Suika for offline</button>
    </p>
    
  </div>

  <script>
    // Register service worker at root so it controls all pages
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js').catch(()=>{});
    }

    // Ask the service worker to precache game assets when user clicks the button
    document.addEventListener('DOMContentLoaded', () => {
      const btn = document.getElementById('download-offline');
      if (!btn) return;
      btn.addEventListener('click', async () => {
        if (!navigator.serviceWorker?.controller) {
          alert('Service worker not active yet — try again in a moment.');
          return;
        }

        // List of assets to pre-cache for suika.
        const urls = [
          '/suika/index.html', '/suika/index.js', '/suika/matter.js', '/suika/offline.html',
        ];
        // Add images/sounds under assets folder
        const assets = [
          '/suika/assets/img/bg-menu.png',
          '/suika/assets/img/pop.png',
        ];
        // Add a few sample circle images if present
        for (let i=0;i<=10;i++) urls.push(`/suika/assets/img/circle${i}.png`);
        navigator.serviceWorker.controller.postMessage({ type: 'PRECACHE_URLS', urls: urls.concat(assets) });
        btn.innerText = 'Downloading…';
        setTimeout(()=>btn.innerText = 'Downloaded (or queued)', 1500);
      });
    });
  </script>
</body>
</html>
